{"version":3,"sources":["assets\\Script\\Common\\manage\\Api\\QgRewardedAd.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Tools from \"../../Tools\";\r\nimport Global from \"../../Global\";\r\nimport LogMgr from \"../../LogMgr\";\r\n\r\nexport default class QgRewardedAd {\r\n\r\n    private static rewardedAd: any; //视频对象\r\n    public static isLoad_Rewarded: boolean = false;\r\n    private static rewardedVideoResolve = null; //视频状态返回 1 : 播放完成， 2 : 播放错误, 3 : 播放中途关闭\r\n\r\n    public static createRewardedVideo() {\r\n        return new Promise((resolve, reject) => {\r\n\r\n            if (!Global.isVivo) {\r\n                LogMgr.error('当前非vivo平台，无法创建视频') ;\r\n                reject(false);\r\n                return\r\n            }\r\n\r\n            let unitId = Tools.getRandomByArray(Global.config.advertisingConfig.rewardedVideoAdId);\r\n            if (!unitId) {\r\n                LogMgr.error('视频ID获取失败：' + unitId)\r\n                reject(false);\r\n                return\r\n            }\r\n\r\n            // @ts-ignore\r\n            this.rewardedAd = window.qg.createRewardedVideoAd({posId: unitId});\r\n\r\n            this.rewardedAd.onError(err => {\r\n                LogMgr.error(\"激励视频广告错误\", err);\r\n                this.rewardedVideoResolve(2);\r\n                this.rewardedVideoResolve = null;\r\n            });\r\n\r\n            this.rewardedAd.onClose((isEnded) => { //开启关闭监听\r\n                if (isEnded.isEnded) {\r\n                    this.rewardedVideoResolve(1); //播放完成\r\n                } else {\r\n                    this.rewardedVideoResolve(3); //中途关闭\r\n                }\r\n                this.isLoad_Rewarded = false;\r\n                this.rewardedVideoResolve = null;\r\n                this.loadRewardedVideo().then() ;\r\n            })\r\n\r\n            this.rewardedAd.onLoad((res)=> {\r\n                this.isLoad_Rewarded = true;\r\n                LogMgr.log('激励视频广告加载完成-onload触发', JSON.stringify(res));\r\n            })\r\n\r\n            resolve(true);\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 加载视频\r\n     */\r\n    public static loadRewardedVideo() {\r\n        return new Promise((resolve, reject) => {\r\n            if (!this.rewardedAd) {\r\n                LogMgr.error('视频未创建>>>无法load()')\r\n                this.createRewardedVideo().then()\r\n                reject(false)\r\n                return\r\n            }\r\n            this.rewardedAd.load().then(() => {\r\n                resolve(true);\r\n            }, (error) => {\r\n                LogMgr.error('视频加载失败：' + error);\r\n                reject(false) ;\r\n            });\r\n        })\r\n    }\r\n\r\n    /**\r\n     * show视频\r\n     */\r\n    public static showRewardedVideo() {\r\n        return new Promise((resolve) => {\r\n            this.rewardedVideoResolve = resolve;\r\n            if (!this.isLoad_Rewarded) {\r\n                this.rewardedVideoResolve(2);\r\n                this.loadRewardedVideo().then() ;\r\n                LogMgr.error('视频加载中......');\r\n                return\r\n            }\r\n            this.rewardedAd.show().then(() => {\r\n\r\n            }).catch((err) => {\r\n                LogMgr.error('激励视频广告展示失败', JSON.stringify(err));\r\n            })\r\n        })\r\n    }\r\n}"]}