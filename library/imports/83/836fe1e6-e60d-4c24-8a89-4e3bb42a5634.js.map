{"version":3,"sources":["assets\\Script\\SDK\\JiuWuSDK.ts"],"names":[],"mappings":";;;;;;AAAA,yCAAoC;AACpC,2CAAsC;AACtC,oDAA+C;AAE/C,2CAAsC;AACtC,sDAAiD;AAEjD;IAAA;IA2HA,CAAC;IA/FiB,yBAAgB,GAA9B;QAAA,iBAwBC;QAvBG,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YAC/B,KAAI,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC;gBACd,KAAI,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,UAAC,IAAI;oBACtB,gBAAM,CAAC,OAAO,GAAG,IAAI,CAAC;oBAEtB,IAAI,OAAO,GAAG,gBAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;oBAC/C,kBAAQ,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;oBACjC,kBAAQ,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;oBACjC,kBAAQ,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;oBACjC,aAAa;oBACb,gBAAM,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,gBAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;oBAEjE,eAAK,CAAC,SAAS,EAAE,CAAE;oBAEnB,gBAAM,CAAC,GAAG,CAAC,YAAY,CAAC,CAAA;oBACxB,KAAI,CAAC,OAAO,GAAG,IAAI,CAAC;oBACpB,OAAO,CAAC,IAAI,CAAC,CAAC;gBAClB,CAAC,EAAE;oBACC,gBAAM,CAAC,KAAK,CAAC,YAAY,CAAC,CAAA;gBAC9B,CAAC,CAAC,CAAA;YACN,CAAC,CAAC,CAAA;QAEN,CAAC,CAAC,CAAA;IACN,CAAC;IAED;;OAEG;IACW,iBAAQ,GAAtB;QAAA,iBAqCC;QApCG,IAAI;YACA,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;gBAC/B,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;gBAC3B,IAAI,KAAK,GAAiB,MAAM,CAAC,IAAI,CAAC,CAAC;gBACvC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;gBAC3B,KAAK,CAAC,GAAG,GAAG,eAAK,CAAC,OAAO,EAAE,GAAG,qBAAqB,CAAC;gBACpD,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;gBAC3B,KAAK,CAAC,IAAI,GAAG;oBACT,IAAI,EAAE,KAAI,CAAC,OAAO;oBAClB,MAAM,EAAE,KAAI,CAAC,QAAQ,CAAC,MAAM;oBAC5B,QAAQ,EAAE,SAAS;oBACnB,QAAQ,EAAE,SAAS;oBACnB,OAAO,EAAE,KAAI,CAAC,QAAQ,CAAC,WAAW;iBACrC,CAAA;gBACD,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;gBAC3B,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;gBACtB,KAAK,CAAC,MAAM,GAAG,KAAI,CAAC,OAAO,EAAE,CAAC;gBAC9B,KAAK,CAAC,MAAM,CAAC,cAAc,CAAC,GAAG,kBAAkB,CAAC;gBAClD,KAAK,CAAC,OAAO,GAAG,UAAC,GAAG;oBAChB,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,KAAK,GAAG,EAAE;wBACvB,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,GAAG,CAAC,CAAA;wBAC7B,OAAO,CAAC,GAAG,CAAC,CAAC;qBAChB;yBAAM;wBACH,OAAO,CAAC,KAAK,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;wBAC5B,MAAM,CAAC,GAAG,CAAC,CAAC;qBACf;gBACL,CAAC,CAAC;gBACF,KAAK,CAAC,IAAI,GAAG,UAAC,GAAG;oBACb,OAAO,CAAC,KAAK,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;gBAClC,CAAC,CAAA;gBACD,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;gBAC3B,eAAK,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;YAC9B,CAAC,CAAC,CAAC;SACN;QAAC,OAAO,CAAC,EAAE;YACR,OAAO,CAAC,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;SAC/B;IACL,CAAC;IAED;;OAEG;IACW,cAAK,GAAnB;QAAA,iBAeC;QAdG,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YAC/B,IAAI;gBACA,eAAK,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,UAAC,KAAK;oBACrB,IAAI,KAAK,IAAI,KAAK,EAAE;wBAChB,KAAI,CAAC,OAAO,GAAG,KAAK,CAAC;wBACrB,OAAO,CAAC,IAAI,CAAC,CAAC;qBACjB;gBACL,CAAC,EAAE;oBACC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;gBACzB,CAAC,CAAC,CAAA;aACL;YAAC,OAAO,CAAC,EAAE;gBACR,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;aAClC;QACL,CAAC,CAAC,CAAA;IACN,CAAC;IAEa,gBAAO,GAArB;QACI,OAAO;YACH,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,MAAM;YAChC,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK;SACjC,CAAA;IACL,CAAC;IAvHa,gBAAO,GAAQ,IAAI,CAAC;IAEpB,gBAAO,GAAY,KAAK,CAAC;IAEzB,YAAG,GAAG;QAChB,IAAI,EAAE,0BAA0B;QAChC,IAAI,EAAE,0BAA0B;KACnC,CAAA;IAEa,iBAAQ,GAAa;QAC/B,MAAM,EAAE,GAAG;QACX,WAAW,EAAE,UAAU;QACvB,MAAM,EAAE,kCAAkC;QAC1C,KAAK,EAAE,8DAA8D;KACxE,CAAA;IAEa,mBAAU,GAAe;QACnC,KAAK,EAAE,EAAE;QACT,KAAK,EAAE,IAAI;QACX,WAAW,EAAE,EAAE;QACf,YAAY,EAAE;YACV,KAAK,EAAE,EAAE;YACT,SAAS,EAAE,IAAI;SAClB;KACJ,CAAA;IAiGL,eAAC;CA3HD,AA2HC,IAAA;kBA3HoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["import Tools from \"../Common/Tools\";\r\nimport Global from \"../Common/Global\";\r\nimport QgApi from \"../Common/manage/Api/QgApi\";\r\nimport Loading from \"../Scene/Loading\";\r\nimport LogMgr from \"../Common/LogMgr\";\r\nimport CacheMgr from \"../Common/manage/CacheMgr\";\r\n\r\nexport default class JiuWuSDK {\r\n\r\n    public static qgToken: any = null;\r\n\r\n    public static initSDK: boolean = false;\r\n\r\n    public static url = {\r\n        test: \"https://api.jiuwugame.cn\",\r\n        host: \"https://api.jiuwugame.cn\",\r\n    }\r\n\r\n    public static gameInfo: GameInfo = {\r\n        gameId: 125,\r\n        gameVersion: \"20211026\",\r\n        client: '95e7b3d7beceea9a7b85a3235892e728',\r\n        token: '$2a$10$gjXXqXHT85QpdRZSsS8QZuu6AnI5hJL/ZzyJ8yzMCit2ii7RhGd.W',\r\n    }\r\n\r\n    public static launchData: launchData = {\r\n        scene: '',\r\n        query: null,\r\n        shareTicket: '',\r\n        referrerInfo: {\r\n            appId: '',\r\n            extraData: null\r\n        }\r\n    }\r\n\r\n    public static inSet_API_Config() {\r\n        return new Promise((resolve, reject) => {\r\n            this.login().then(() => {\r\n                this.register().then((data) => {\r\n                    Global.allData = data;\r\n\r\n                    let gmsUser = Global.allData.data.data.gmsUser;\r\n                    CacheMgr.userId = gmsUser.userId;\r\n                    CacheMgr.openId = gmsUser.openId;\r\n                    CacheMgr.isAuth = gmsUser.isAuth;\r\n                    // @ts-ignore\r\n                    Global.config = JSON.parse(Global.allData.data.data.versionMode);\r\n\r\n                    QgApi.createAdv() ;\r\n\r\n                    LogMgr.log('一切就绪......')\r\n                    this.initSDK = true;\r\n                    resolve(true);\r\n                }, () => {\r\n                    LogMgr.error('就绪失败......')\r\n                })\r\n            })\r\n\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 后台 注册或者登录\r\n     */\r\n    public static register() {\r\n        try {\r\n            return new Promise((resolve, reject) => {\r\n                console.log('准备发送请求......')\r\n                let param: regisMessage = Object(null);\r\n                console.log('发送请求中......A')\r\n                param.url = Tools.getHost() + '/api/login/loginsum';\r\n                console.log('发送请求中......B')\r\n                param.data = {\r\n                    code: this.qgToken,\r\n                    gameId: this.gameInfo.gameId,\r\n                    sceneVal: undefined,\r\n                    exportId: undefined,\r\n                    version: this.gameInfo.gameVersion,\r\n                }\r\n                console.log('发送请求中......C')\r\n                param.method = 'POST';\r\n                param.header = this.headers();\r\n                param.header['content-type'] = 'application/json';\r\n                param.success = (res) => {\r\n                    if (res.data.code === 200) {\r\n                        console.log('后台登录注册成功：', res)\r\n                        resolve(res);\r\n                    } else {\r\n                        console.error('登录错误：', res);\r\n                        reject(res);\r\n                    }\r\n                };\r\n                param.fail = (err) => {\r\n                    console.error('发送请求失败：', err);\r\n                }\r\n                console.log('发送请求中......D')\r\n                QgApi.sponsorHttps(param);\r\n            });\r\n        } catch (e) {\r\n            console.error('后台登录错误:', e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 登录vivo\r\n     */\r\n    public static login() {\r\n        return new Promise((resolve, reject) => {\r\n            try {\r\n                QgApi.login().then((token) => {\r\n                    if (token != false) {\r\n                        this.qgToken = token;\r\n                        resolve(true);\r\n                    }\r\n                }, () => {\r\n                    console.error('登录失败')\r\n                })\r\n            } catch (e) {\r\n                console.log(' login error', e);\r\n            }\r\n        })\r\n    }\r\n\r\n    public static headers() {\r\n        return {\r\n            'x-client': this.gameInfo.client,\r\n            'x-token': this.gameInfo.token\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\ninterface GameInfo {\r\n    gameId: number,\r\n    gameVersion: string,\r\n    client: string,\r\n    token: string\r\n}\r\n\r\ninterface launchData {\r\n    scene: string,\r\n    query: any,\r\n    shareTicket: string,\r\n    referrerInfo: referrerInfo\r\n}\r\n\r\nexport interface referrerInfo {\r\n    appId: string,\r\n    extraData: any\r\n}\r\n\r\nexport interface regisMessage {\r\n    url: string,\r\n    data: object,\r\n    method: string,\r\n    success: any,\r\n    fail: any,\r\n    header: any\r\n}\r\n\r\n"]}