{"version":3,"sources":["assets\\Script\\Moudle\\View\\NativeView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import LayerPanel, {UrlInfo} from \"../../Common/manage/Layer/LayerPanel\";\r\nimport Texture2D = cc.Texture2D;\r\nimport QgNative from \"../../Common/manage/Api/QgNative\";\r\nimport Emit from \"../../Common/manage/Emit/Emit\";\r\nimport EmitData from \"../../Common/manage/Emit/EmitData\";\r\nimport QgBanner from \"../../Common/manage/Api/QgBanner\";\r\nimport PanelMgr from \"../../Common/manage/PanelMgr\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nconst {TOUCH_START} = cc.Node.EventType ;\r\n\r\n@ccclass\r\nexport default class NativeView extends LayerPanel {\r\n\r\n    public static getUrl(): UrlInfo {\r\n        return {\r\n            bundle: \"nativeView\",\r\n            name: \"nativeView\"\r\n        }\r\n    }\r\n\r\n    @property(cc.Node)\r\n    native_inters: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    native_implant: cc.Node = null;\r\n\r\n    private nativeMessage : any = null ;\r\n\r\n    private currSprite : cc.Texture2D = null ;\r\n\r\n    private adId : string = null ;\r\n\r\n    private labelType : number = null ;\r\n\r\n    private labelArr : string[] = ['点击查看','点击跳过'] ;\r\n\r\n    private type : number = null ;\r\n\r\n    initUI() {\r\n        this.initTouch() ;\r\n    }\r\n\r\n    show(param: any): void {\r\n        this.node.getChildByName('inputEvent').active = false ;\r\n        this.node.getChildByName('inputEvent_implant').active = false ;\r\n\r\n        this.native_inters.active = false ;\r\n        this.native_implant.active = false ;\r\n\r\n        this.labelType = param.labelType ;\r\n        this.type = param.type ;\r\n\r\n        this.scheduleOnce(()=>{\r\n            if (QgNative.nativeMessage != null) {\r\n                this.nativeMessage = QgNative.nativeMessage ;\r\n                this.open_type(param.type) ;\r\n            }else {\r\n                QgNative.loadNative().then((res)=>{\r\n                    if (res && res != false) {\r\n                        this.nativeMessage = res ;\r\n                        this.open_type(param.type) ;\r\n                    }else {\r\n\r\n                    }\r\n                })\r\n            }\r\n        },param.time) ;\r\n\r\n        if (this.type == 2) {\r\n            Emit.instance().on(EmitData.CLOSE_NATIVE,this.closeNative,this) ;\r\n        }\r\n\r\n    }\r\n\r\n    openNative (node : cc.Node) {\r\n        node.getChildByName('title').getComponent(cc.Label).string = this.nativeMessage.desc ;\r\n\r\n        let imgUrl = null ;\r\n        if (this.nativeMessage.imgUrlList && this.nativeMessage.imgUrlList.length > 0) {\r\n            imgUrl = this.nativeMessage.imgUrlList[0] ;\r\n        }\r\n\r\n        if (imgUrl != null) {\r\n            cc.assetManager.loadRemote(imgUrl,{ext: '.png'},(err, asset : Texture2D)=>{\r\n                if (err) {\r\n                    console.error('原生广告图片加载错误>>>>>>',err) ;\r\n                    return\r\n                }\r\n\r\n                this.currSprite = asset ;\r\n                node.getChildByName('image').getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(this.currSprite) ;\r\n\r\n            })\r\n        }\r\n\r\n        this.adId = this.nativeMessage.adId ;\r\n        QgNative.repAdShow(this.nativeMessage.adId) ;\r\n\r\n    }\r\n\r\n    open_type (type) {\r\n        if (!this.nativeMessage)  {\r\n            return\r\n        }\r\n\r\n        if (type == 1) {\r\n            this.node.getChildByName('inputEvent').active = true ;\r\n\r\n            this.native_inters.getChildByName('nativeBtn').getChildByName('label').getComponent(cc.Label).string = this.labelArr[this.labelType - 1] ;\r\n\r\n            this.native_inters.getChildByName('close').active = false ;\r\n            this.native_inters.active = true ;\r\n            this.scheduleOnce(()=>{\r\n                this.native_inters.getChildByName('close').active = true ;\r\n            },2)\r\n\r\n            this.openNative(this.native_inters) ;\r\n        }\r\n\r\n        if (type == 2) {\r\n            QgBanner.hideBanner() ;\r\n            this.node.getChildByName('inputEvent_implant').active = true ;\r\n\r\n            this.native_implant.getChildByName('nativeBtn').getChildByName('label').getComponent(cc.Label).string = this.labelArr[this.labelType - 1] ;\r\n\r\n            this.native_implant.getChildByName('close').active = false ;\r\n            this.native_implant.active = true ;\r\n            this.scheduleOnce(()=>{\r\n                this.native_implant.getChildByName('close').active = true ;\r\n            },2)\r\n\r\n            this.openNative(this.native_implant) ;\r\n        }\r\n\r\n    }\r\n\r\n    initTouch () {\r\n        this.native_inters.getChildByName('image').on(TOUCH_START,()=>{\r\n            QgNative.repAdClick(this.adId) ;\r\n        })\r\n\r\n        this.native_implant.getChildByName('image').on(TOUCH_START,()=>{\r\n            QgNative.repAdClick(this.adId) ;\r\n        })\r\n\r\n        this.native_inters.getChildByName('nativeBtn').on(TOUCH_START,()=>{\r\n            this.handlerNativeBtn() ;\r\n        })\r\n\r\n        this.native_implant.getChildByName('nativeBtn').on(TOUCH_START,()=>{\r\n            this.handlerNativeBtn() ;\r\n        })\r\n\r\n        this.native_inters.getChildByName('close').on(TOUCH_START,()=>{\r\n            this.closeNative() ;\r\n        })\r\n\r\n        this.native_implant.getChildByName('close').on(TOUCH_START,()=>{\r\n            this.closeNative() ;\r\n        })\r\n\r\n    }\r\n\r\n    handlerNativeBtn () {\r\n       if (this.labelType == 1)  {\r\n           QgNative.repAdClick(this.adId) ;\r\n       }else {\r\n           this.closeNative() ;\r\n       }\r\n    }\r\n\r\n    hide() {\r\n        QgNative.anewLoad() ;\r\n        Emit.instance().emit(EmitData.IN_NATIVE_NEXT) ;\r\n        if (this.type == 2) {\r\n            QgBanner.showBanner() ;\r\n            Emit.instance().off(EmitData.CLOSE_NATIVE,this.closeNative,this) ;\r\n        }\r\n    }\r\n\r\n    closeNative() {\r\n        PanelMgr.INS.closePanel(NativeView,false) ;\r\n    }\r\n\r\n\r\n    // update (dt) {}\r\n}\r\n"]}